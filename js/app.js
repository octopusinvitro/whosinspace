"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var Client=function(){function t(){_classCallCheck(this,t),this._url="http://api.open-notify.org",this._astronautsEndpoint="/astros.json",this._issEndpoint="/iss-now.json"}return _createClass(t,[{key:"getAstronauts",value:function(t,e){var n={url:this.astronautsURL,onSuccess:t,onFailure:e,property:"people"};this._getURL(n)}},{key:"getISSPosition",value:function(t,e){var n={url:this.issURL,onSuccess:t,onFailure:e,property:"iss_position"};this._getURL(n)}},{key:"_getURL",value:function(e){var t=this,n=new XMLHttpRequest;try{n.responseType="json",n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e.onSuccess(n.response[e.property]):e.onFailure(t._buildHTTPError(n)))},n.open("GET",e.url),n.setRequestHeader("Accept","application/json"),n.send()}catch(t){e.onFailure(this._buildGenericError(n,t))}}},{key:"_buildHTTPError",value:function(t){return{status:Number.isInteger(t.status)?t.status:"",statusText:t.statusText,url:t.url,body:t.response}}},{key:"astronautsURL",get:function(){return"".concat(this._url).concat(this._astronautsEndpoint)}},{key:"issURL",get:function(){return"".concat(this._url).concat(this._issEndpoint)}}]),t}(),Map=function(){function e(t){_classCallCheck(this,e),this.map=L.map(t),this._marker=null,this._initialZoom=3,this._iconImage={source:"../img/iss.png",width:191,height:100,alt:"ISS station"},this._decimalPositions=2,this._token="pk.eyJ1Ijoib2N0b3B1c2ludml0cm8iLCJhIjoiY2s5cTZ5MnRlMGhlOTNubW14dWQ3NjJkNCJ9.G-rrNuSyagqnbFLpRG1aag",this._attribution='Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',this.initialize()}return _createClass(e,[{key:"initialize",value:function(){this.map.setZoom(this._initialZoom),this._addTile(),this._addMarker()}},{key:"update",value:function(t,e){this.map=this.map.setView([t,e]),this._marker.setLatLng(L.latLng(t,e)),this._marker.bindPopup(this._popupContent(t,e)).openPopup()}},{key:"_addTile",value:function(){var t={attribution:this._attribution,maxZoom:18,id:"mapbox/satellite-streets-v11",tileSize:512,zoomOffset:-1,accessToken:this._token};L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",t).addTo(this.map)}},{key:"_addMarker",value:function(){var t={icon:L.icon({iconUrl:this._iconImage.source,iconSize:[this._iconImage.width,this._iconImage.height],iconAnchor:[this._iconImage.width/2,this._iconImage.height/2],popupAnchor:[0,-this._iconImage.height/2]}),alt:this._iconImage.alt};this._marker=L.marker([0,0],t).addTo(this.map)}},{key:"_popupContent",value:function(t,e){return"The ISS is at lat: <strong>".concat(this._truncate(t),"</strong>, lon: <strong>").concat(this._truncate(e),"</strong>.")}},{key:"_truncate",value:function(t){return Number.parseFloat(t).toFixed(this._decimalPositions)}}]),e}(),UI=function(){function o(t,e,n){var s=this;_classCallCheck(this,o),this.update=function(){s._client.getAstronauts(s._onAstronautsSuccess,s._onFailure),s._client.getISSPosition(s._onPositionSuccess,s._onFailure)},this.displayClock=function(t){s._clock.textContent="".concat(s._zeroPad(t.hour),":").concat(s._zeroPad(t.minutes),":").concat(s._zeroPad(t.seconds))},this.toggleAlertClock=function(){s._clock.classList.add(s._alertClockClass),s._clock.classList.remove(s._defaultClockClass)},this.toggleDefaultClock=function(){s._clock.classList.remove(s._alertClockClass),s._clock.classList.add(s._defaultClockClass)},this._onAstronautsSuccess=function(t){s._updateCount(t),s._updateTable(t)},this._onPositionSuccess=function(t){s._map.update(t.latitude,t.longitude)},this._updateCount=function(t){s._count.textContent=t.length},this._updateTable=function(t){var e,n=new DocumentFragment;t.forEach(function(t){e=document.createElement("tr"),e.insertCell(0).textContent=t.name,e.insertCell(1).textContent=t.craft,n.appendChild(e)}),s._table.innerHTML="",s._table.appendChild(n)},this._onFailure=function(t){s._error.textContent+="Error: ".concat(t.status," ").concat(t.statusText,", when requesting URL ").concat(t.url,".\n").concat(t.body)},this._client=t,this._map=e,this._count=document.getElementById(n.countID),this._table=document.getElementById(n.astronautsID),this._error=document.getElementById(n.errorID),this._clock=document.getElementById(n.clockID),this._defaultClockClass=n.defaultClockClass,this._alertClockClass=n.alertClockClass,document.getElementById("call-to-action").addEventListener("click",function(){console.log("hi")})}return _createClass(o,[{key:"_zeroPad",value:function(t){return t.toString().padStart(2,"0")}}]),o}(),Clock=function e(t){var n=this;_classCallCheck(this,e),this.start=function(){n.tick(),setTimeout(n.start,e.SMALL_TICK)},this.tick=function(){var t=n._now();n._ui.displayClock(t),n._isLongTick(t.seconds)&&(new Audio("tada.mp3").play(),n._ui.update(),n._ui.toggleAlertClock()),n._isNormalTick(t.seconds)&&n._ui.toggleDefaultClock()},this._now=function(){var t=new Date;return{hour:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds()}},this._isLongTick=function(t){return t%(e.LONG_TICK/1e3)==0},this._isNormalTick=function(t){return t%(e.LONG_TICK/1e3)==1},this._ui=t};Clock.SMALL_TICK=1e3,Clock.LONG_TICK=5e3;
//# sourceMappingURL=app.js.map
